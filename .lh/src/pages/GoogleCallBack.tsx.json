{
    "sourceFile": "src/pages/GoogleCallBack.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1763050159941,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1763050199268,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,19 +1,22 @@\n // pages/GoogleCallback.tsx\r\n import { useEffect } from \"react\";\r\n import { useSearchParams, useNavigate } from \"react-router-dom\";\r\n import jwt_decode from \"jwt-decode\";\r\n-import { useAuth } from \"../context/AuthContext\";\r\n+// AuthContext import removed because '../context/AuthContext' is not available in this project setup.\r\n+// We will provide a local fallback for setUser below to avoid compile errors.\r\n \r\n interface User {\r\n   id: string;\r\n   name: string;\r\n     email: string;\r\n }\r\n \r\n-export default function GoogleCallback() {\r\n   const [searchParams] = useSearchParams();\r\n   const navigate = useNavigate();\r\n+  // Fallback no-op setUser for environments where AuthContext is not present.\r\n+  // If you add AuthContext later, replace this with: const { setUser } = useAuth() as any;\r\n+  const setUser = (user: any) => {};\r\n   const { setUser } = useAuth() as any;\r\n \r\n   useEffect(() => {\r\n     const token = searchParams.get(\"token\");\r\n"
                },
                {
                    "date": 1763050283423,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,22 +1,19 @@\n // pages/GoogleCallback.tsx\r\n import { useEffect } from \"react\";\r\n import { useSearchParams, useNavigate } from \"react-router-dom\";\r\n import jwt_decode from \"jwt-decode\";\r\n-// AuthContext import removed because '../context/AuthContext' is not available in this project setup.\r\n-// We will provide a local fallback for setUser below to avoid compile errors.\r\n+import { useAuth } from \"../context/AuthContext\";\r\n \r\n interface User {\r\n   id: string;\r\n   name: string;\r\n     email: string;\r\n }\r\n \r\n+export default function GoogleCallback() {\r\n   const [searchParams] = useSearchParams();\r\n   const navigate = useNavigate();\r\n-  // Fallback no-op setUser for environments where AuthContext is not present.\r\n-  // If you add AuthContext later, replace this with: const { setUser } = useAuth() as any;\r\n-  const setUser = (user: any) => {};\r\n   const { setUser } = useAuth() as any;\r\n \r\n   useEffect(() => {\r\n     const token = searchParams.get(\"token\");\r\n"
                },
                {
                    "date": 1763050629030,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,31 +1,35 @@\n-// pages/GoogleCallback.tsx\r\n-import { useEffect } from \"react\";\r\n-import { useSearchParams, useNavigate } from \"react-router-dom\";\r\n-import jwt_decode from \"jwt-decode\";\r\n-import { useAuth } from \"../context/AuthContext\";\r\n+import React, { useEffect } from \"react\";\r\n+import { useAuth } from \"../context/AuthContext\"; // path to your updated AuthContext\r\n+import { useNavigate } from \"react-router-dom\";\r\n \r\n-interface User {\r\n-  id: string;\r\n-  name: string;\r\n-    email: string;\r\n-}\r\n-\r\n-export default function GoogleCallback() {\r\n-  const [searchParams] = useSearchParams();\r\n+const GoogleCallback: React.FC = () => {\r\n+  const { setUser } = useAuth();\r\n   const navigate = useNavigate();\r\n-  const { setUser } = useAuth() as any;\r\n \r\n   useEffect(() => {\r\n-    const token = searchParams.get(\"token\");\r\n-    if (token) {\r\n-      const user = jwt_decode<User>(token);\r\n-      localStorage.setItem(\"carfinder_user\", JSON.stringify(user));\r\n-      setUser(user);\r\n-      navigate(\"/\"); // redirect to homepage\r\n+    // Extract query params sent by backend after Google login\r\n+    const params = new URLSearchParams(window.location.search);\r\n+    const userParam = params.get(\"user\"); // backend should send user info as JSON string\r\n+\r\n+    if (userParam) {\r\n+      try {\r\n+        const decodedUser = JSON.parse(decodeURIComponent(userParam));\r\n+        setUser(decodedUser);\r\n+        localStorage.setItem(\"carfinder_user\", JSON.stringify(decodedUser));\r\n+        navigate(\"/\"); // redirect to home/welcome page\r\n+      } catch (err) {\r\n+        console.error(\"Failed to parse Google user\", err);\r\n+      }\r\n     } else {\r\n-      navigate(\"/login\"); // fallback\r\n+      console.error(\"No user info returned from Google login\");\r\n     }\r\n-  }, []);\r\n+  }, [setUser, navigate]);\r\n \r\n-  return <div>Logging in via Google...</div>;\r\n-}\r\n+  return (\r\n+    <div className=\"flex items-center justify-center min-h-screen\">\r\n+      <p className=\"text-lg font-semibold\">Logging in with Google...</p>\r\n+    </div>\r\n+  );\r\n+};\r\n+\r\n+export default GoogleCallback;\r\n"
                },
                {
                    "date": 1763051036848,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,35 +1,30 @@\n-import React, { useEffect } from \"react\";\r\n-import { useAuth } from \"../context/AuthContext\"; // path to your updated AuthContext\r\n-import { useNavigate } from \"react-router-dom\";\r\n+import { useEffect } from \"react\";\r\n+import { useNavigate, useSearchParams } from \"react-router-dom\";\r\n+import { useAuth } from \"@/contexts/AuthContext\";\r\n \r\n-const GoogleCallback: React.FC = () => {\r\n+const GoogleCallback = () => {\r\n+  const [searchParams] = useSearchParams();\r\n+  const navigate = useNavigate();\r\n   const { setUser } = useAuth();\r\n-  const navigate = useNavigate();\r\n \r\n   useEffect(() => {\r\n-    // Extract query params sent by backend after Google login\r\n-    const params = new URLSearchParams(window.location.search);\r\n-    const userParam = params.get(\"user\"); // backend should send user info as JSON string\r\n-\r\n+    const userParam = searchParams.get(\"user\");\r\n     if (userParam) {\r\n       try {\r\n-        const decodedUser = JSON.parse(decodeURIComponent(userParam));\r\n-        setUser(decodedUser);\r\n-        localStorage.setItem(\"carfinder_user\", JSON.stringify(decodedUser));\r\n-        navigate(\"/\"); // redirect to home/welcome page\r\n+        const user = JSON.parse(decodeURIComponent(userParam));\r\n+        setUser(user); // Set user in AuthContext and localStorage\r\n+        localStorage.setItem(\"carfinder_user\", JSON.stringify(user));\r\n+        navigate(\"/\"); // Redirect to home\r\n       } catch (err) {\r\n-        console.error(\"Failed to parse Google user\", err);\r\n+        console.error(\"Failed to parse Google user:\", err);\r\n+        navigate(\"/login\");\r\n       }\r\n     } else {\r\n-      console.error(\"No user info returned from Google login\");\r\n+      navigate(\"/login\");\r\n     }\r\n-  }, [setUser, navigate]);\r\n+  }, [searchParams, setUser, navigate]);\r\n \r\n-  return (\r\n-    <div className=\"flex items-center justify-center min-h-screen\">\r\n-      <p className=\"text-lg font-semibold\">Logging in with Google...</p>\r\n-    </div>\r\n-  );\r\n+  return <div>Loading...</div>;\r\n };\r\n \r\n export default GoogleCallback;\r\n"
                },
                {
                    "date": 1763055411431,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,30 +1,30 @@\n-import { useEffect } from \"react\";\r\n-import { useNavigate, useSearchParams } from \"react-router-dom\";\r\n-import { useAuth } from \"@/contexts/AuthContext\";\r\n+// import { useEffect } from \"react\";\r\n+// import { useNavigate, useSearchParams } from \"react-router-dom\";\r\n+// import { useAuth } from \"@/contexts/AuthContext\";\r\n \r\n-const GoogleCallback = () => {\r\n-  const [searchParams] = useSearchParams();\r\n-  const navigate = useNavigate();\r\n-  const { setUser } = useAuth();\r\n+// const GoogleCallback = () => {\r\n+//   const [searchParams] = useSearchParams();\r\n+//   const navigate = useNavigate();\r\n+//   const { setUser } = useAuth();\r\n \r\n-  useEffect(() => {\r\n-    const userParam = searchParams.get(\"user\");\r\n-    if (userParam) {\r\n-      try {\r\n-        const user = JSON.parse(decodeURIComponent(userParam));\r\n-        setUser(user); // Set user in AuthContext and localStorage\r\n-        localStorage.setItem(\"carfinder_user\", JSON.stringify(user));\r\n-        navigate(\"/\"); // Redirect to home\r\n-      } catch (err) {\r\n-        console.error(\"Failed to parse Google user:\", err);\r\n-        navigate(\"/login\");\r\n-      }\r\n-    } else {\r\n-      navigate(\"/login\");\r\n-    }\r\n-  }, [searchParams, setUser, navigate]);\r\n+//   useEffect(() => {\r\n+//     const userParam = searchParams.get(\"user\");\r\n+//     if (userParam) {\r\n+//       try {\r\n+//         const user = JSON.parse(decodeURIComponent(userParam));\r\n+//         setUser(user); // Set user in AuthContext and localStorage\r\n+//         localStorage.setItem(\"carfinder_user\", JSON.stringify(user));\r\n+//         navigate(\"/\"); // Redirect to home\r\n+//       } catch (err) {\r\n+//         console.error(\"Failed to parse Google user:\", err);\r\n+//         navigate(\"/login\");\r\n+//       }\r\n+//     } else {\r\n+//       navigate(\"/login\");\r\n+//     }\r\n+//   }, [searchParams, setUser, navigate]);\r\n \r\n-  return <div>Loading...</div>;\r\n-};\r\n+//   return <div>Loading...</div>;\r\n+// };\r\n \r\n-export default GoogleCallback;\r\n+// export default GoogleCallback;\r\n"
                }
            ],
            "date": 1763050159941,
            "name": "Commit-0",
            "content": "// pages/GoogleCallback.tsx\r\nimport { useEffect } from \"react\";\r\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\n\r\ninterface User {\r\n  id: string;\r\n  name: string;\r\n    email: string;\r\n}\r\n\r\nexport default function GoogleCallback() {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const { setUser } = useAuth() as any;\r\n\r\n  useEffect(() => {\r\n    const token = searchParams.get(\"token\");\r\n    if (token) {\r\n      const user = jwt_decode<User>(token);\r\n      localStorage.setItem(\"carfinder_user\", JSON.stringify(user));\r\n      setUser(user);\r\n      navigate(\"/\"); // redirect to homepage\r\n    } else {\r\n      navigate(\"/login\"); // fallback\r\n    }\r\n  }, []);\r\n\r\n  return <div>Logging in via Google...</div>;\r\n}\r\n"
        }
    ]
}