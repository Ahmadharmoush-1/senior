{
    "sourceFile": "src/components/ui/ChatBot.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1764345091516,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1764345091516,
            "name": "Commit-0",
            "content": "import React, { useState } from \"react\";\r\nimport { MessageCircle, Send, X } from \"lucide-react\";\r\n\r\ninterface ChatMessage {\r\n  id: string;\r\n  sender: \"user\" | \"bot\";\r\n  content: string;\r\n}\r\n\r\nconst API_URL = \"http://localhost:5000/api/chat\";\r\n\r\nexport const ChatBot: React.FC = () => {\r\n  const [open, setOpen] = useState(false);\r\n  const [input, setInput] = useState(\"\");\r\n  const [messages, setMessages] = useState<ChatMessage[]>([\r\n    {\r\n      id: \"welcome\",\r\n      sender: \"bot\",\r\n      content:\r\n        \"üëã Hello! I'm your AI assistant. Ask me anything about buying or selling cars!\",\r\n    },\r\n  ]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const sendMessage = async () => {\r\n    if (!input.trim()) return;\r\n\r\n    const userMessage: ChatMessage = {\r\n      id: Date.now().toString(),\r\n      sender: \"user\",\r\n      content: input.trim(),\r\n    };\r\n\r\n    setMessages((prev) => [...prev, userMessage]);\r\n    setInput(\"\");\r\n    setLoading(true);\r\n\r\n    try {\r\n      const history = messages.map((m) => ({\r\n        role: m.sender === \"user\" ? \"user\" : \"assistant\",\r\n        content: m.content,\r\n      }));\r\n\r\n      const res = await fetch(API_URL, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          message: userMessage.content,\r\n          history,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      const botMsg: ChatMessage = {\r\n        id: Date.now().toString() + \"_bot\",\r\n        sender: \"bot\",\r\n        content: data.reply,\r\n      };\r\n\r\n      setMessages((prev) => [...prev, botMsg]);\r\n    } catch {\r\n      setMessages((prev) => [\r\n        ...prev,\r\n        {\r\n          id: \"error\",\r\n          sender: \"bot\",\r\n          content: \"‚ö†Ô∏è Something went wrong. Try again.\",\r\n        },\r\n      ]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Floating Chat Button */}\r\n      <button\r\n        onClick={() => setOpen(true)}\r\n        className=\"fixed bottom-5 right-5 z-50 w-14 h-14 bg-blue-600 text-white rounded-full flex items-center justify-center shadow-xl hover:scale-105 transition\"\r\n      >\r\n        <MessageCircle className=\"w-6 h-6\" />\r\n      </button>\r\n\r\n      {/* Chat Container */}\r\n      {open && (\r\n        <div className=\"fixed bottom-20 right-5 w-80 md:w-96 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-xl shadow-2xl z-50 flex flex-col\">\r\n          {/* Header */}\r\n          <div className=\"bg-blue-600 text-white py-3 px-4 flex justify-between items-center\">\r\n            <p className=\"font-semibold\">AI Assistant</p>\r\n            <button onClick={() => setOpen(false)}>\r\n              <X className=\"w-5 h-5\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Messages */}\r\n          <div className=\"p-3 h-80 overflow-y-auto space-y-2 bg-gray-50 dark:bg-gray-800\">\r\n            {messages.map((msg) => (\r\n              <div\r\n                key={msg.id}\r\n                className={`flex ${\r\n                  msg.sender === \"user\" ? \"justify-end\" : \"justify-start\"\r\n                }`}\r\n              >\r\n                <div\r\n                  className={`px-3 py-2 rounded-lg max-w-[75%] text-sm ${\r\n                    msg.sender === \"user\"\r\n                      ? \"bg-blue-600 text-white rounded-br-none\"\r\n                      : \"bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 rounded-bl-none\"\r\n                  }`}\r\n                >\r\n                  {msg.content}\r\n                </div>\r\n              </div>\r\n            ))}\r\n            {loading && (\r\n              <div className=\"text-gray-500 text-sm\">AI is typing...</div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Input */}\r\n          <div className=\"p-3 flex items-center border-t dark:border-gray-700 bg-white dark:bg-gray-900\">\r\n            <input\r\n              className=\"flex-1 px-3 py-2 text-sm rounded-lg border dark:border-gray-700 dark:bg-gray-800 focus:outline-none\"\r\n              placeholder=\"Ask something...\"\r\n              value={input}\r\n              onChange={(e) => setInput(e.target.value)}\r\n              onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\r\n            />\r\n            <button\r\n              onClick={sendMessage}\r\n              className=\"ml-2 p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\r\n            >\r\n              <Send className=\"w-4 h-4\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n"
        }
    ]
}