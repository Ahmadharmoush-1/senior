{
    "sourceFile": "src/components/MapDisplay.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1759939466087,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1759939466087,
            "name": "Commit-0",
            "content": "import { useEffect, useRef, useState } from \"react\";\r\nimport mapboxgl from \"mapbox-gl\";\r\nimport \"mapbox-gl/dist/mapbox-gl.css\";\r\nimport { MapPin } from \"lucide-react\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\n\r\ninterface MapDisplayProps {\r\n  lat: number;\r\n  lng: number;\r\n  title?: string;\r\n}\r\n\r\nconst MapDisplay = ({ lat, lng, title = \"Car Location\" }: MapDisplayProps) => {\r\n  const mapContainer = useRef<HTMLDivElement>(null);\r\n  const map = useRef<mapboxgl.Map | null>(null);\r\n  const [mapboxToken, setMapboxToken] = useState(localStorage.getItem(\"mapbox_token\") || \"\");\r\n  const [needsToken, setNeedsToken] = useState(!localStorage.getItem(\"mapbox_token\"));\r\n\r\n  useEffect(() => {\r\n    if (!mapContainer.current || !mapboxToken) return;\r\n\r\n    try {\r\n      mapboxgl.accessToken = mapboxToken;\r\n      localStorage.setItem(\"mapbox_token\", mapboxToken);\r\n\r\n      map.current = new mapboxgl.Map({\r\n        container: mapContainer.current,\r\n        style: \"mapbox://styles/mapbox/streets-v12\",\r\n        center: [lng, lat],\r\n        zoom: 13,\r\n      });\r\n\r\n      map.current.addControl(new mapboxgl.NavigationControl(), \"top-right\");\r\n\r\n      // Add marker\r\n      new mapboxgl.Marker({ color: \"#3b82f6\" })\r\n        .setLngLat([lng, lat])\r\n        .setPopup(new mapboxgl.Popup().setHTML(`<h3 class=\"font-semibold\">${title}</h3>`))\r\n        .addTo(map.current);\r\n\r\n      setNeedsToken(false);\r\n    } catch (error) {\r\n      console.error(\"Map initialization error:\", error);\r\n    }\r\n\r\n    return () => {\r\n      map.current?.remove();\r\n    };\r\n  }, [mapboxToken, lat, lng, title]);\r\n\r\n  if (needsToken) {\r\n    return (\r\n      <div className=\"space-y-3 rounded-lg border border-dashed bg-muted/30 p-6\">\r\n        <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n          <MapPin className=\"h-5 w-5\" />\r\n          <p className=\"text-sm font-medium\">Location Map</p>\r\n        </div>\r\n        <p className=\"text-sm text-muted-foreground\">\r\n          To view the location map, please enter your Mapbox token. Get one free at{\" \"}\r\n          <a href=\"https://mapbox.com\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-primary hover:underline\">\r\n            mapbox.com\r\n          </a>\r\n        </p>\r\n        <div className=\"space-y-2\">\r\n          <Label htmlFor=\"mapbox-token-display\">Mapbox Token</Label>\r\n          <Input\r\n            id=\"mapbox-token-display\"\r\n            type=\"text\"\r\n            placeholder=\"pk.ey...\"\r\n            value={mapboxToken}\r\n            onChange={(e) => setMapboxToken(e.target.value)}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      <div ref={mapContainer} className=\"h-[400px] w-full rounded-lg border shadow-sm animate-fade-in\" />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MapDisplay;"
        }
    ]
}