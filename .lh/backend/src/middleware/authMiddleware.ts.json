{
    "sourceFile": "backend/src/middleware/authMiddleware.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1761147630052,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1761147640100,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,1 @@\n-//protects \n\\ No newline at end of file\n+//protects routes like \"Sell \"\n\\ No newline at end of file\n"
                },
                {
                    "date": 1761149898322,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,27 @@\n-//protects routes like \"Sell Car\", \"Buy Car\"\n\\ No newline at end of file\n+//protects routes like \"Sell Car\", \"Buy Car\"\r\n+import { Request, Response, NextFunction } from 'express';\r\n+import jwt from 'jsonwebtoken';\r\n+import dotenv from 'dotenv';\r\n+dotenv.config();\r\n+\r\n+const JWT_SECRET = process.env.JWT_SECRET!;\r\n+\r\n+export interface AuthRequest extends Request {\r\n+  user?: any;\r\n+}\r\n+\r\n+export const verifyToken = (req: AuthRequest, res: Response, next: NextFunction) => {\r\n+  const authHeader = req.headers.authorization;\r\n+  if (!authHeader) return res.status(401).json({ message: 'Authorization header missing' });\r\n+\r\n+  const token = authHeader.split(' ')[1]; // \"Bearer <token>\"\r\n+  if (!token) return res.status(401).json({ message: 'Token missing' });\r\n+\r\n+  try {\r\n+    const decoded = jwt.verify(token, JWT_SECRET);\r\n+    req.user = decoded;\r\n+    next();\r\n+  } catch (err) {\r\n+    return res.status(401).json({ message: 'Invalid or expired token' });\r\n+  }\r\n+};\r\n"
                }
            ],
            "date": 1761147630052,
            "name": "Commit-0",
            "content": "//"
        }
    ]
}