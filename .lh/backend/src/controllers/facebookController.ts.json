{
    "sourceFile": "backend/src/controllers/facebookController.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1763934025504,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1763934025504,
            "name": "Commit-0",
            "content": "import { Request, Response } from \"express\";\r\nimport puppeteer from \"puppeteer\";\r\n\r\nexport const scrapeFacebook = async (req: Request, res: Response) => {\r\n  try {\r\n    const { url } = req.body;\r\n    if (!url) return res.status(400).json({ message: \"URL is required\" });\r\n\r\n    const browser = await puppeteer.launch({\r\n      headless: true,\r\n      args: [\"--no-sandbox\", \"--disable-setuid-sandbox\"],\r\n    });\r\n\r\n    const page = await browser.newPage();\r\n    await page.goto(url, { waitUntil: \"networkidle2\" });\r\n\r\n    const data = await page.evaluate(() => {\r\n      const title = document.querySelector(\"h1\")?.textContent || \"\";\r\n      const price = document.querySelector(\"span[dir='auto']\")?.textContent || \"\";\r\n      const desc = document.querySelector(\"[data-ad-preview='message']\")?.textContent || \"\";\r\n      const images = [...document.querySelectorAll(\"img\")].map((img) => img.src);\r\n\r\n      return { title, price, desc, images };\r\n    });\r\n\r\n    await browser.close();\r\n    return res.json({ success: true, data });\r\n\r\n  } catch (err) {\r\n    return res.status(500).json({ message: \"Scraping failed\" });\r\n  }\r\n};\r\n"
        }
    ]
}